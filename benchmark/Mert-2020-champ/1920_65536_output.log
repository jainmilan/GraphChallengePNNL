
NUMBER OF PROCESS: 1
NUMBER OF THREADS: 16

DATASET: /lus/grand/projects/GRACE/spdnn/dataset
NUMBER OF NEURONS: 65536
NUMBER OF LAYERS: 1920
BATCH SIZE: 60000
INPUT NZ: 392191985
BIAS: -0.450000

PARTITIONING
proc 0 batch: 60000/60000 extbatch 60000

READING WEIGHTS
weights: 4026531840 (24.159191 GB)
500,55
/lus/grand/projects/GRACE/spdnn/dataset/neuron65536.bin
open /lus/grand/projects/GRACE/spdnn/dataset/neuron65536.binREADING INPUT
about to memcpy 15000 MB
done memcpy
features: 7864320000 (31.457280 GB)
extbatch=60000, neuron=65536
myid 0 mydevice 0

Device Count: 8
Device 0 name: NVIDIA A100-SXM4-80GB
Computational Capabilities: 8, 0
Maximum global memory size: 85198045184
Maximum constant memory size: 65536
Maximum shared memory size per block: 49152
Maximum block dimensions: 1024x1024x64
Maximum grid dimensions: 2147483647x65535x65535
Maximum threads per block: 1024
Warp size: 32

MINIBATCH SIZE: 12
BLOCK SIZE: 256
WARP SIZE: 32
NUM BLOCKS: 256
NUMWARPS: 8
BUFFER SIZE: 6144 (24.000000 KB) PER FEATURE: 512 (2.000000 KB)

total buffers: 5734400 (11.666667 per block)
total map: -1443495936 (-2936.800049 per block)
total warpnz: 287738496 (50.177612 per buffer)
iefficiency: 2.286740

OUT OF CORE IS ENABLED
OVERLAPPING IS ENABLED

mapsizemax: 2097152 (4.194304 KB)
weightsizemax: 5576192 (33.457152 KB)
cudaMalloc 15000 MB
cudaMalloc 15000 MB

GPU 0: OTHERS: 0.000480 DISPLS: 0.208428 MAPS: 0.008389 WEIGHTS: 0.066914 FEATURES: 31.457280 TOTAL: 31.741010 GB
MAX GPU MEM: 31.741010 GB

START INFERENCE
END INFERENCE

CHECK CATEGORIES
proc 0 categories: 1994
all categories: 1994
CHALLENGE PASSED!

      I/O TIME: 45.534112 s
INFERENCE TIME: 31.348798 s
INFERENCE THRP: 7.706577e+12 EDGES/s (15.413153 TFLOPS)
--------------------------------------
KERNEL TIME: 3.124463e+01 s
  COPY TIME: 0.000000e+00 s
 OTHER TIME: 1.041680e-01 s
 TOTAL TIME: 3.134880e+01 s

EXECUTION TIME: 151.248411
